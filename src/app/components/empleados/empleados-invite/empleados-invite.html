<div class="invite-container">
  
  <div class="modo-selector">
    <button [class.activo]="modo() === 'escanear'" (click)="cambiarModo('escanear')">Escanear QR</button>
    <button [class.activo]="modo() === 'manual'" (click)="cambiarModo('manual')">Búsqueda Manual</button>
  </div>

  <div class="modo-contenido">

    @if (modo() === 'escanear' && !empleadoEncontrado() && !cargando()) {
      <div class="scan-wrapper">
        <p>Apunte la cámara al código QR del invitado</p>
        <zxing-scanner (scanSuccess)="onScanSuccess($event)"></zxing-scanner>
      </div>
    }

    @if (modo() === 'manual' && !empleadoEncontrado() && !cargando()) {
      <div class="manual-wrapper">
        <p>Ingrese el documento del invitado</p>
        <form (ngSubmit)="buscarManualmente()">
          <input type="text" 
                 placeholder="Documento" 
                 [ngModel]="documentoManual()"
                 (ngModelChange)="documentoManual.set($event)"
                 name="documentoManual" />
          <button type.="submit">Buscar</button>
        </form>
      </div>
    }

    @if (cargando()) {
      <div class="mensaje-estado">
        <p>Buscando...</p>
      </div>
    }

    @if (mensaje() && !empleadoEncontrado()) {
      <div class="mensaje-estado error">
        <p>{{ mensaje() }}</p>
        <button (click)="resetearEstado()">Intentar de nuevo</button>
      </div>
    }

    @if (empleadoEncontrado(); as empleado) {
      <div class="resultado-wrapper">
        <h3>Invitado Encontrado</h3>
        
        <div class="tarjeta-empleado">
          <p><strong>Nombre:</strong> {{ empleado.nombre }}</p>
          <p><strong>Documento:</strong> {{ empleado.documento }}</p>
          <p><strong>Empresa:</strong> {{ empleado.Empresa }}</p>
          <p><strong>Sector:</strong> {{ empleado.Sector }}</p>
        </div>

        @if (mensaje()) {
          <div class="mensaje-estado" [class.asistio]="empleado.Asistio">
            <p>{{ mensaje() }}</p>
          </div>
        }

        @if (!empleado.Asistio) {
          <button class="boton-asistencia" (click)="marcarAsistencia()" [disabled]="cargando()">
            Marcar Asistencia
          </button>
        } @else {
          <button (click)="escanearDeNuevo()">Escanear Siguiente</button>
        }
      </div>
    }

  </div>
</div>