<div class="invite-container">
  
  <div class="modo-selector">
    <button [class.activo]="modo() === 'escanear'" (click)="cambiarModo('escanear')">Escanear QR</button>
    <button [class.activo]="modo() === 'manual'" (click)="cambiarModo('manual')">Búsqueda Manual</button>
  </div>

  <div class="modo-contenido">

    @if (modo() === 'escanear') {
      <div class="scan-wrapper">
        <p>Apunte la cámara al código QR del invitado</p>

        @if (scannerEnabled()) {
          <zxing-scanner
            (scanSuccess)="onScanSuccess($event)"
            (camerasFound)="onCamerasFound($event)"
            [device]="currentDevice()"
            [enable]="scannerEnabled()">
          </zxing-scanner>
        }

        @if (devices().length > 1) {
          <div class="camera-selector">
            <label for="camera-select">Cambiar cámara:</label>
            <select id="camera-select" (change)="onCameraChange($event)">
              @for (device of devices(); track device.deviceId) {
                <option 
                  [value]="device.deviceId" 
                  [selected]="device.deviceId === currentDevice()?.deviceId">
                  {{ device.label }}
                </option>
              }
            </select>
          </div>
        }
      </div>
    }

    @if (modo() === 'manual') {
      <div class="manual-wrapper">
        <p>Ingrese el documento del invitado</p>
        <form (ngSubmit)="buscarManualmente()">
          <input type="text" 
                 placeholder="Documento" 
                 [ngModel]="documentoManual()"
                 (ngModelChange)="documentoManual.set($event)"
                 name="documentoManual" />
          <button type="submit" [disabled]="cargando()">
            @if(cargando()) {
              <span>Buscando...</span>
            } @else {
              <span>Buscar</span>
            }
          </button>
        </form>
      </div>
    }

    @if (cargando() && modo() === 'escanear') {
      <div class="mensaje-estado">
        <p>Procesando escaneo...</p>
      </div>
    }

    </div>
</div>